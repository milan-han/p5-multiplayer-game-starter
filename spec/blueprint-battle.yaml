# Canonical Blueprint Battle gameplay balance constants
# All numbers that affect gameplay should live here for easy tuning.

server:
  port: 8080                  # Server port for HTTP and Socket.IO
  game_loop_interval_ms: 16   # Game loop update interval (60Hz)

arena:
  world_size: 8000            # Total side length of the square world, in px
  tile_size: 250              # Size of a single walkable square, in px
  tile_ratio: 0.9             # % of a tile that is drawn as the inner neon square
  tile_density: 0.7           # Probability that a tile exists at a grid coord (1 - skip chance)
  ammo_spawn_probability: 0.2 # Chance that a given tile initially spawns a cyan ammo circle
  minimum_tiles: 50           # Minimum number of tiles required for spawning
  ammo_respawn_delay_ms: 15000 # Time before ammo respawns after pickup (15 seconds)

player:
  move_cooldown_speed_mode: 5   # Frames between auto‚Äêsteps while sprinting (Shift held)
  move_cooldown_normal_ms: 100  # Minimum milliseconds between normal moves
  shield_alpha_rate: 0.1        # Speed at which shield fades in/out each frame
  heading_interp: 0.15          # Interpolation factor for tank rotation smoothing
  position_interp: 0.8          # Interpolation factor for tank position smoothing
  rotation_step_deg: 90         # Degrees rotated per ArrowLeft/ArrowRight press
  initial_ammo: 1               # Starting ammo count for new players
  max_ammo: 1                   # Maximum ammo a player can carry
  initial_heading: -90          # Starting heading for new players (North)
  speed_mode_cooldown: 0        # Cooldown frames for speed mode activation
  look_ahead:
    normal: 150                 # Camera look-ahead distance when walking
    speed_mode: 250             # Camera look-ahead distance when sprinting
  shield:
    radius_offset: 30           # Extra pixels added to half tile size for shield arc radius
    arc_width_deg: 150          # Degrees of shield coverage (front arc)
    line_width: 3               # Stroke width of shield arc in px

bullet:
  initial_speed: 100    # Starting velocity of a fired ball
  drag: 0.97            # Per-frame drag multiplier applied to speed
  life_frames: 120      # Lifetime of a bullet before it disappears
  radius: 6             # Render radius of a bullet in px

combat:
  shoot_cooldown_ms: 250        # Minimum delay between shots
  respawn_delay_ms: 3000        # Time before respawn after death (3 seconds)
  max_reflections: 3            # Maximum bullet reflections off shields
  tank_hit_radius_divisor: 4    # Tank hit radius = tile_size / this value
  reflection_randomness: 0.2    # Random angle added to bullet reflections
  push_distance: 5              # Distance to push bullet away from shield after reflection

camera:
  lerp_factor: 0.1         # Interpolation factor for camera position/rotation
  shake_magnitude: 15      # Initial shake offset applied on shot
  shake_decay: 0.9         # Per-frame decay multiplier for shake magnitude
  visibility_margin: 100   # Extra margin for visibility culling
  shake_threshold: 1       # Minimum shake magnitude to apply shake effect
  shake_multiplier: 2      # Multiplier for shake effect on shooting
  fov_blocks: 12          # Desired number of tiles visible across the screen width (camera zoom)

visual:
  # Tank rendering
  tank_shadow_blur: 15        # Shadow blur radius for tank outline
  tank_line_width: 2          # Line width for tank outline
  ammo_indicator_radius: 15   # Radius of ammo indicator dot inside tank
  
  # Bullet rendering  
  bullet_trail_length: 5      # Number of trail segments behind bullet
  bullet_glow_shadow_blur: 10 # Shadow blur for bullet glow effect
  bullet_inner_alpha: 0.8     # Alpha for bullet inner circle
  bullet_inner_radius_ratio: 0.5 # Inner circle radius as ratio of bullet radius
  bullet_trail_alpha: 0.6     # Alpha for bullet trail segments
  bullet_fade_threshold: 0.3  # Life ratio below which bullet starts fading
  bullet_visibility_margin: 4 # Visibility margin multiplier for bullet radius
  
  # Arena rendering
  arena_tile_alpha: 0.25      # Alpha for arena tile outlines
  arena_tile_line_width: 1    # Line width for arena tiles
  arena_ammo_alpha: 0.4       # Alpha for ammo spawn indicators - increased visibility
  arena_ammo_line_width: 1.5  # Line width for ammo spawn circles
  arena_grid_alpha: 0.4       # Alpha for background grid lines - increased to match prototype
  arena_grid_line_width: 1    # Line width for background grid lines
  arena_label_alpha: 0.25     # Alpha for tile coordinate labels
  arena_ammo_radius: 12       # Radius of ammo pickup circles
  arena_ammo_shadow_blur: 8   # Shadow blur for ammo glow effect
  
  # Shield rendering
  shield_shadow_blur: 10      # Shadow blur radius for shield arc
  
  # Combat effects
  combat_effects:
    muzzle_flash_duration: 5       # Frames to show muzzle flash effect
    muzzle_flash_intensity: 25     # Intensity of muzzle flash glow
    hit_flash_duration: 8          # Frames to show hit impact flash
    hit_flash_radius: 20           # Radius of hit impact flash (px)
    death_fade_duration: 30        # Frames for death fade-out effect
    death_fade_alpha: 0.05         # Alpha reduction per frame during death fade
    impact_shake_magnitude: 8      # Camera shake intensity for bullet impacts
    death_shake_magnitude: 20      # Camera shake intensity for player death

background_pattern:
  cell_size: 20   # Grid cell size (px) of the repeating dot background
  dot_radius: 0.5 # Radius of each dot (px)
  dot_alpha: 0.2  # Transparency of dots (0-1)

# UI styling and layout configuration
ui:
  # Positioning and spacing
  hud_position:
    top: 20         # Top offset for HUD elements (px)
    left: 20        # Left offset for HUD elements (px)
  
  # Thresholds and tolerances
  prediction_error_threshold: 5     # Position prediction error tolerance (px)
  heading_error_threshold: 5        # Heading prediction error tolerance (degrees)
  
  # Crosshair dimensions
  crosshair_size: 5                # Half-size of crosshair lines (px)
  
  # Label positioning
  tile_label_offset: 15            # Y offset for tile coordinate labels (px)
  
  # Camera shake fallback
  camera_shake_fallback: 15        # Default shake magnitude when CONFIG not available
  
  # Frame/time conversion
  frame_to_ms: 16                  # Frame to millisecond conversion factor

  # Login overlay styling
  login_overlay:
    background_alpha: 0.85             # Background overlay transparency - slightly more opaque
    input_width: 345                   # Width of name input field (px) - 15% wider
    input_height: 55                   # Height of name input field (px) - slightly taller
    button_width: 345                  # Width of play button (px) - match input width
    button_height: 55                  # Height of play button (px) - match input height
    element_spacing: 45                # Spacing between elements (px) - more breathing room
    font_size: 16                      # Font size for overlay text (px) - slightly smaller for precision
    title_font_size: 30                # Font size for main title (px)
    title_glow_intensity: 55           # Reduced glow for crisp letters
    glow_intensity: 30                 # Glow effect intensity for focused elements - tamed
    border_width: 1                    # Hair-line border width (px)
    input_background_alpha: 0.05       # Translucent cyan glass for input field
    button_inner_glow_alpha: 0.15      # Subtle inner glow for button panel
    frosted_glass_alpha: 0.12          # Semi-opaque frosted glass background
    frosted_glass_blur: 8              # Blur effect for frosted glass (simulated)
    unified_cyan: '#26c6da'            # Single cyan value for consistency
    padding_vertical: 20               # Extra vertical padding inside elements
    
  # Leaderboard styling
  leaderboard:
    position:
      top: 20                      # Top offset from screen edge (px)
      right: 20                    # Right offset from screen edge (px)
    width: 220                     # Width of leaderboard panel (px) - slightly wider
    row_height: 28                 # Height of each player row (px) - more breathing room
    max_players: 10                # Maximum players to display
    font_size: 13                  # Font size for player names and scores
    header_font_size: 15           # Font size for leaderboard header
    padding: 15                    # Internal padding (px) - more generous
    background_alpha: 0.08         # Background transparency - translucent cyan
    background_color: 'rgba(0, 180, 200, 0.08)'  # Translucent cyan panel
    border_width: 1                # Border width (px)
    border_color: '#26c6da'        # Cyan outline color
    title_letter_spacing: '0.1em'  # Wide-tracked uppercase for title
    title_font_weight: 'bold'      # Title font weight
    divider_alpha: 0.3             # Faint divider line transparency
    top_player_glow_intensity: 15  # Glow intensity for top player
    regular_player_alpha: 0.7      # Dimmer alpha for non-top players
    pulse_speed: 0.02              # Speed of additive pulse for position changes
    frosted_glass_alpha: 0.18      # Semi-opaque frosted glass background - more opaque
    inner_padding: 12              # Inner padding for frosted glass effect
    
  # Death screen and respawn countdown
  death_screen:
    background_alpha: 0.7          # Background overlay transparency
    countdown_font_size: 48        # Font size for countdown timer (px)
    message_font_size: 24          # Font size for death message (px)
    button_width: 200              # Width of respawn button (px)
    button_height: 60              # Height of respawn button (px)
    element_spacing: 30            # Spacing between elements (px)
    glow_intensity: 20             # Glow effect intensity for countdown
    pulse_speed: 0.05              # Speed of pulsing effects
    
  # Kill streak display
  killstreak_display:
    position:
      bottom: 20                   # Bottom offset from screen edge (px)
      right: 20                    # Right offset from screen edge (px)
    width: 180                     # Width of kill streak panel (px)
    height: 55                     # Height of kill streak panel (px)
    font_size: 16                  # Font size for kill streak counter - slightly smaller
    label_font_size: 12            # Font size for "Kill Streak:" label
    glow_intensity: 8              # Glow effect intensity - reduced to match leaderboard level
    spacing: 8                     # Spacing between label and number (px)
    frosted_glass_alpha: 0.18      # Semi-opaque frosted glass background - more opaque
    padding: 12                    # Internal padding (px)
    border_width: 1                # Hair-line border width (px)
    
  # Animation system configuration
  anim:
    # Interpolation and timing
    interpolation_delay_ms: 33         # Render delay behind server (2 ticks at 60Hz)
    interpolation_buffer_size: 10      # Number of state snapshots to store
    delta_time_smoothing: 0.1          # Smoothing factor for delta time calculation
    
    # Easing functions and curves
    ease_out_cubic: 0.25              # Cubic easing factor for smooth transitions
    ease_in_out_quad: 0.5             # Quadratic easing for UI animations
    ease_linear: 1.0                  # Linear easing for constant animations
    
    # Animation durations (milliseconds)
    shield_glow_fade_ms: 200          # Shield fade in/out duration
    muzzle_flash_duration_ms: 83      # Muzzle flash duration (5 frames at 60Hz)
    hit_flash_duration_ms: 133        # Hit flash duration (8 frames at 60Hz)
    death_fade_duration_ms: 500       # Death fade duration (30 frames at 60Hz)
    respawn_flash_duration_ms: 300    # Respawn flash duration
    
    # Position and rotation interpolation
    position_lerp_factor: 0.8         # Position interpolation speed
    rotation_lerp_factor: 0.15        # Rotation interpolation speed
    camera_lerp_factor: 0.1           # Camera follow interpolation speed
    
    # Visual effect parameters
    alpha_fade_rate: 0.02             # Alpha fade rate per frame (60Hz)
    glow_pulse_speed: 0.005           # Glow pulse animation speed
    shake_decay_rate: 0.9             # Camera shake decay per frame
    trail_fade_rate: 0.8              # Bullet trail fade rate
    
    # State machine timings
    movement_state_transition_ms: 50  # Movement state transition timing
    combat_state_transition_ms: 100   # Combat state transition timing
    effect_state_transition_ms: 16    # Effect state transition timing (1 frame)
    
    # Frame rate independence
    target_fps: 60                    # Target FPS for frame-independent calculations
    max_delta_time: 0.033             # Maximum delta time (33ms) to prevent large jumps
    min_delta_time: 0.008             # Minimum delta time (8ms) for very fast systems

# Color palette for "Living Blueprint" aesthetic
colors:
  # Base colors
  base: '#000000'           # Background base color
  primary_stroke: '#9EE7FF' # Primary neon blue stroke
  dim_stroke: '#3A5F7F'     # Dimmed blue stroke
  glow_accent: '#00FFF7'    # Cyan glow accent
  error_accent: '#FF5C5C'   # Red error/player accent
  
  # Player color palette - distinct colors for multiplayer
  player_colors:
    - '#FF5C5C'  # Red
    - '#00FFF7'  # Cyan
    - '#9EE7FF'  # Light Blue
    - '#FFD700'  # Gold
    - '#FF69B4'  # Hot Pink
    - '#00FF00'  # Lime Green
    - '#FF8C00'  # Orange
    - '#8A2BE2'  # Blue Violet
    - '#ADFF2F'  # Green Yellow
    - '#FF1493'  # Deep Pink
  
  # Additional colors for UI elements
  white: '#FFFFFF'          # Pure white for inner elements
  tile_outline: '#FFFFFF'   # Tile outline color
  
  # Leaderboard specific colors
  leaderboard_cyan: '#26c6da'      # Cyan outline and accent color
  leaderboard_bg: 'rgba(0, 180, 200, 0.08)'  # Translucent cyan background
  leaderboard_dim_cyan: 'rgba(0, 180, 200, 0.7)'  # Dimmer cyan for regular players
  
  # CSS-specific colors (will be converted to CSS custom properties)
  css_background: '#000000'  # Body background color
  css_text: '#9EE7FF'       # UI text color

# Typography configuration
typography:
  # Font families
  primary_font: 'Inter'     # Primary font family
  title_font: 'Menlo, Monaco, "SF Mono", "Courier New", monospace'  # Angular monospace font for title
  monospace_font: 'Monaco, "Lucida Console", monospace'  # Monospace font for leaderboard
  
  # Font sizes
  ui_font_size: 16          # Main UI text size (px)
  tile_label_size: 12       # Tile coordinate label size (px)
  
  # Font weights
  ui_font_weight: 600       # UI text weight
  
  # Error message styling
  error_message_style: 'color: #FF5C5C; font-family: Inter; padding: 20px; text-align: center;'

# Patterns and arrays
patterns:
  # Line dash patterns
  ammo_dash: [4, 4]         # Dash pattern for ammo spawn circles
  
  # Spacing patterns
  shadow_blur_multiplier: 0.5  # Multiplier for inner shadow blur effects

# CSS custom properties generation
css_overrides:
  # Generate CSS custom properties for these values
  generate_css_vars: true
  
  # Values that need to be available in CSS
  body_background: '#000000'
  ui_text_color: '#9EE7FF'
  ui_font_size: '16px'
  ui_font_weight: '600'
  ui_top_offset: '20px'
  ui_left_offset: '20px'
